!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("PanoptoCore"),require("Hls"),require("_"),require("jQuery")):"function"==typeof define&&define.amd?define(["PanoptoCore","Hls","_","jQuery"],t):"object"==typeof exports?exports.PanoptoViewer=t(require("PanoptoCore"),require("Hls"),require("_"),require("jQuery")):e.PanoptoViewer=t(e.PanoptoCore,e.Hls,e._,e.jQuery)}(window,(function(e,t,r,i){return function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/dist/",r(r.s=4)}([function(t,r){t.exports=e},function(e,r){e.exports=t},function(e,t){e.exports=r},function(e,t){e.exports=i},function(e,t,r){"use strict";r.r(t);var i={};r.r(i),r.d(i,"StreamContentType",(function(){return G})),r.d(i,"ViewerPlayState",(function(){return C}));var n=r(1),o=r(0),a=function(){function e(){}return e.prototype.formatHlsjsMessage=function(e){return"[hls.js] > "+e},e.prototype.debug=function(e){arguments.length>0&&o.Logging.Logger.debug(this.formatHlsjsMessage(e))},e.prototype.log=function(e){arguments.length>0&&o.Logging.Logger.verbose(this.formatHlsjsMessage(e))},e.prototype.info=function(e){arguments.length>0&&o.Logging.Logger.info(this.formatHlsjsMessage(e))},e.prototype.warn=function(e){arguments.length>0&&o.Logging.Logger.warning(this.formatHlsjsMessage(e))},e.prototype.error=function(e){arguments.length>0&&o.Logging.Logger.error(this.formatHlsjsMessage(e))},e}();function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t,r){var i=r.value;if("function"!=typeof i)throw new TypeError("@boundMethod decorator can only be applied to methods not: ".concat(s(i)));var n=!1;return{configurable:!0,get:function(){if(n||this===e.prototype||this.hasOwnProperty(t)||"function"!=typeof i)return i;var r=i.bind(this);return n=!0,Object.defineProperty(this,t,{configurable:!0,get:function(){return r},set:function(e){i=e,delete this[t]}}),n=!1,r},set:function(e){i=e}}}var u=function(e,t,r,i){var n,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(o<3?n(a):o>3?n(t,r,a):n(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a},d=function(){function e(e,t){this.instanceId=e,this.hlsEngine=t,this.hasAudioSwapped=!1,t.on(n.Events.ERROR,this.handleError)}return e.prototype.handleError=function(e,t){var r=this;if(t.fatal){if(o.Logging.Logger.verbose(this.formatLog("Fatal "+t.type+" error caught.")),t.type===n.ErrorTypes.NETWORK_ERROR)if(navigator.onLine)o.Logging.Logger.verbose(this.formatLog("Network is online, reloading now.")),this.hlsEngine.startLoad();else{o.Logging.Logger.verbose(this.formatLog("Network is offline, reloading later."));var i=function(){o.Logging.Logger.verbose(r.formatLog("Network is back online, reloading now.")),window.removeEventListener("online",i),r.hlsEngine.startLoad()};window.addEventListener("online",i)}if(t.type===n.ErrorTypes.MEDIA_ERROR){var a=Date.now();!this.lastMediaErrorDate||a-this.lastMediaErrorDate>5e3?(o.Logging.Logger.verbose(this.formatLog("First media error, recover.")),this.lastMediaErrorDate=a,this.hlsEngine.recoverMediaError()):this.hasAudioSwapped?o.Logging.Logger.error(this.formatLog("Irrecoverable media error.")):(o.Logging.Logger.verbose(this.formatLog("Second media error, swap audio and recover.")),this.hasAudioSwapped=!0,this.hlsEngine.swapAudioCodec(),this.hlsEngine.recoverMediaError())}}},e.prototype.formatLog=function(e){return"[BaseHlsError] ["+this.instanceId+"] > "+e},u([l],e.prototype,"handleError",null),e}(),c=function(){return(c=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},p=function(){function e(e,t,r,i){var s=this;if(this.id=e,this.container=t,this.video=r,this.loggedVideoEvents=["durationchange","ended","error","loadeddata","loadedmetadata","pause","play","playing","seeked","seeking","stalled","waiting"],n.isSupported())this.hlsEngine=new n(c(c({},i),{debug:new a})),new d(e,this.hlsEngine);else{if(!this.video.canPlayType("application/vnd.apple.mpegurl"))throw new Error("No HLS support. Please call canLoadSource before instantiating HlsStreamPlayer.");o.Logging.Logger.warning("No MSE support but is a Safari with native HLS support.")}var l=function(e){return o.Logging.Logger.verbose("[HlsPrimitive] ["+s.id+"] > "+e.type)};this.loggedVideoEvents.forEach((function(e){return s.video.addEventListener(e,l)})),this.hlsEngine&&this.hlsEngine.on(n.Events.ERROR,(function(e,t){return o.Logging.Logger.error("[HlsPrimitive] ["+s.id+"] > ERROR!",e,t)}))}return e.canLoadSource=function(){return n.isSupported()||!!document.createElement("video").canPlayType("application/vnd.apple.mpegurl")},e.prototype.loadStream=function(e,t){var r=this;if(this.hlsEngine)o.Logging.Logger.info("[HlsPrimitive] ["+this.id+"] > loading source via Hls",e),this.hlsEngine.loadSource(e),this.hlsEngine.attachMedia(this.video),this.hlsEngine.on(n.Events.MANIFEST_PARSED,t);else{o.Logging.Logger.info("[HlsPrimitive] ["+this.id+"] > loading source via <video/> element",e),this.video.src=e;var i=function(){r.video.removeEventListener("loadedmetadata",i),t()};this.video.addEventListener("loadedmetadata",i)}},e.prototype.dispose=function(){this.hlsEngine&&this.hlsEngine.destroy()},e.prototype.addEventListener=function(e,t){this.video.addEventListener(e,t)},e.prototype.play=function(){o.Logging.Logger.info("[HlsPrimitive] ["+this.id+"] > play()"),this.video.play()},e.prototype.pause=function(){o.Logging.Logger.info("[HlsPrimitive] ["+this.id+"] > pause()"),this.video.pause()},Object.defineProperty(e.prototype,"streamPosition",{get:function(){return this.video.currentTime},set:function(e){o.Logging.Logger.info("[HlsPrimitive] ["+this.id+"] > seeking stream to "+e),this.video.currentTime=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"muted",{get:function(){return this.video.muted},set:function(e){o.Logging.Logger.info("[HlsPrimitive] ["+this.id+"] > muted",e),this.video.muted=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"volume",{get:function(){return this.video.volume},set:function(e){o.Logging.Logger.info("[HlsPrimitive] ["+this.id+"] > volume",e),this.video.volume=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){return this.video.duration},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paused",{get:function(){return this.video.paused},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ended",{get:function(){return this.video.ended},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"playbackRate",{get:function(){return this.video.playbackRate},set:function(e){o.Logging.Logger.info("[HlsPrimitive] ["+this.id+"] > playbackRate",e),this.video.playbackRate=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"levels",{get:function(){var e;return(null===(e=this.hlsEngine)||void 0===e?void 0:e.levels)||[]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"currentLevel",{get:function(){var e;return(null===(e=this.hlsEngine)||void 0===e?void 0:e.currentLevel)||-1},set:function(e){o.Logging.Logger.info("[HlsPrimitive] ["+this.id+"] > currentLevel",e),this.hlsEngine&&(this.hlsEngine.currentLevel=e)},enumerable:!0,configurable:!0}),e}();function h(e,t,r,i){return new p(e.id,r,i,t)}var y,g,f=r(3),v=function(){function e(e){this.configuration=e}return e.prototype.ajaxCall=function(e,t,r,i){var n=this;t.responseType="json",f.ajax({url:this.configuration.uriScheme+"://"+this.configuration.webServerFQDN+this.configuration.appRoot+"/Pages/Viewer/"+e,type:"POST",data:t,dataType:"json",success:r,error:i,xhrFields:{withCredentials:!0},beforeSend:function(e){return n.addCsrfHeader(e)}})},e.prototype.ajaxCallOverrideFQDN=function(e,t,r,i,n){var o=this;r.responseType="json",f.ajax({url:this.configuration.uriScheme+"://"+e+this.configuration.appRoot+"/Pages/Viewer/"+t,type:"POST",data:r,dataType:"json",success:i,error:n,xhrFields:{withCredentials:!0},beforeSend:function(e){return o.addCsrfHeader(e)}})},e.prototype.addCsrfHeader=function(e){var t=o.CookieHelpers.getCookie(this.configuration.csrfTokenCookieName);t&&e.setRequestHeader(this.configuration.csrfTokenHeaderName,t)},e.prototype.getDelivery=function(e,t,r,i,n,o){var a="DeliveryInfo.aspx";i.uniqueViewerIdParam&&i.uniqueViewerIdParam.length>0&&(a+="?uhsaWebcastViewerId="+i.uniqueViewerIdParam),i.overrideFQDN?this.ajaxCallOverrideFQDN(i.overrideFQDN,a,{deliveryId:e,tid:t,invocationId:r||"",isLiveNotes:!!i.isLiveNotes,refreshAuthCookie:!!i.refreshAuthCookie,isActiveBroadcast:!!i.isActiveBroadcast,isEditing:!!i.isEditing,isKollectiveAgentInstalled:!!i.isKollectiveAgentInstalled,isEmbed:!!i.isEmbed},(function(e){e.ErrorCode?o(e):n(e)}),o):this.ajaxCall(a,{deliveryId:e,tid:t,invocationId:r||"",isLiveNotes:!!i.isLiveNotes,refreshAuthCookie:!!i.refreshAuthCookie,isActiveBroadcast:!!i.isActiveBroadcast,isEditing:!!i.isEditing,isKollectiveAgentInstalled:!!i.isKollectiveAgentInstalled,isEmbed:!!i.isEmbed},(function(e){e.ErrorCode?o(e):n(e)}),o)},e.prototype.getCaptions=function(e,t,r,i,n){this.ajaxCall("DeliveryInfo.aspx",{deliveryId:e,tid:t,getCaptions:!0,language:r},(function(e){e.ErrorCode?n():i(e)}),n)},e.prototype.rateDelivery=function(e,t,r,i){this.ajaxCall("RateDelivery.aspx",{deliveryID:e,rating:t},(function(e){e.ErrorCode?i():r()}),i)},e.prototype.refreshAuthCookie=function(){this.ajaxCall("RefreshAuthCookie.aspx",{},f.noop,f.noop)},e.prototype.createEvent=function(e,t,r,i,n,o,a,s,l){this.ajaxCall("Notes/Note_Create.aspx",{deliveryId:e,type:t,data:r,time:i,channelName:o||void 0,deliveryRelative:!!n||void 0,createdDuringWebcast:!!a||void 0},(function(e){e.ReturnCode?s(e):l()}),l)},e.prototype.editEvent=function(e,t,r,i,n,o){this.ajaxCall("Notes/Note_Update.aspx",{sessionid:e,type:t,eventid:r,data:i},(function(e){e.ErrorMessage?o():n()}),o)},e.prototype.deleteEvent=function(e,t,r,i,n){this.ajaxCall("Notes/Note_Delete.aspx",{sessionid:e,type:t,eventid:r},(function(e){e.ErrorCode?n():i()}),n)},e.prototype.toggleEventPrivacy=function(e,t,r,i){this.ajaxCall("Notes/TogglePublic.aspx",{id:e,public:!!t||void 0},(function(e){e.Public===t?r(e):i()}),i)},e.prototype.search=function(e,t,r,i,n,o,a,s,l){this.ajaxCall("Search/Results.aspx",{id:e,type:t,query:r,notesUser:i,channelName:n,tid:o,refreshAuthCookie:a,deliveryRelative:!0},(function(e){e.Error?l():s(e.Events)}),l)},e}();!function(e){e.Play="iframePlay",e.Pause="iframePause",e.Mute="iframeMute",e.Unmute="iframeUnmute",e.Seek="iframeSeek",e.Speed="iframeSpeed",e.Volume="iframeVolume",e.Load="iframeLoad",e.Stop="iframeStop",e.CaptionsOff="iframeCaptionsOff",e.CaptionsOn="iframeCaptionsOn"}(y||(y={})),function(e){e.State="iframeState",e.Error="iframeError",e.StateUpdate="iframeStateUpdate",e.SpeedUpdate="iframeSpeedUpdate",e.IframeReady="embedIframeReady"}(g||(g={}));var m,P=function(){function e(e,t){var r=this;this.onCommand=e,this.hostName=t,window.addEventListener("message",(function(e){try{var t=JSON.parse(e.data);"PanoptoEmbed"===t.source&&r.onCommand(t)}catch(e){}}))}return e.prototype.sendPostMessage=function(e,t){var r={msg:e,source:"PanoptoEmbed",data:null==t?"":t};window.parent.postMessage(JSON.stringify(r),this.hostName||"*")},e}(),b=function(){function e(e){this.relativeStart=e.relativeStart,this.relativeEnd=e.relativeEnd,this.segments=e.segments,this.duration=e.length}return e.prototype.updateStream=function(e){this.relativeEnd=e.relativeEnd,this.segments=e.segments},e.prototype.updateDurationFromVideoElement=function(e){this.duration=e},e.prototype.availableAt=function(e){return 0===this.segments.length?0===this.relativeEnd||e<this.relativeStart+this.duration:this.segments.some((function(t){return e>=t.relativeStart&&(t.relativeEnd===1/0||e<t.relativeEnd)}))},e}(),S=function(){function e(e){this.relativeStart=e.relativeStart,this.segments=e.segments,this.duration=e.length,this.liveDurationOffset=(e.broadcastSegmentDuration||9)*(e.broadcastSegmentBackoff||3),this.live=0===e.relativeEnd}return e.prototype.updateStream=function(e){this.segments=e.segments,this.live=0===e.relativeEnd},e.prototype.updateDurationFromVideoElement=function(e){this.duration=e},Object.defineProperty(e.prototype,"livePosition",{get:function(){return this.live?this.duration+this.relativeStart-this.liveDurationOffset:void 0},enumerable:!0,configurable:!0}),e.prototype.convertStreamToTimelinePosition=function(e){return this.segments.length>0?e+this.segments[0].relativeStart:e+this.relativeStart},e.prototype.convertTimelineToStreamPosition=function(e){return this.segments.length>0?e-this.segments[0].relativeStart:e-this.relativeStart},e}(),L=function(e,t,r,i){var n,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(o<3?n(a):o>3?n(t,r,a):n(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a};!function(e){e[e.INITIALIZING=0]="INITIALIZING",e[e.PAUSED=1]="PAUSED",e[e.PAUSE_WHEN_ABLE=2]="PAUSE_WHEN_ABLE",e[e.PLAY_WHEN_READY=3]="PLAY_WHEN_READY",e[e.STARTING=4]="STARTING",e[e.PLAYING=5]="PLAYING"}(m||(m={}));var E,C,I=function(){function e(e,t,r,i,n){var o=this;this.nextSeek=null,this.seekInProgress=null,this._buffering=!1,this._state=m.INITIALIZING,this.primitivePlayer=h(e,t,r,i),this.debug=-1!==window.location.search.indexOf("debug=true"),this.debugInfo=document.createElement("div"),this.debugInfo.classList.add("hls-stream-player-debug-info"),r.append(this.debugInfo),this.id=e.id,this.availabilityController=new b(e),this.timelineController=new S(e),this.attachEventListeners(),this.primitivePlayer.loadStream(e.url,(function(){o.handleStreamLoaded(),n()}))}return e.prototype.attachEventListeners=function(){var e=this;this.primitivePlayer.addEventListener("waiting",(function(){return e._buffering=!0})),this.primitivePlayer.addEventListener("pause",(function(){return e._buffering=!1})),this.primitivePlayer.addEventListener("playing",(function(){return e._buffering=!1})),this.primitivePlayer.addEventListener("play",this.handlePlay),this.primitivePlayer.addEventListener("seeked",this.handleSeeked),this.primitivePlayer.addEventListener("durationchange",this.handleDurationChange),this.debug&&this.updateDebugInfo()},e.prototype.updateDebugInfo=function(){var e=this;requestAnimationFrame((function(){return e.updateDebugInfo()})),this.debugInfo.innerText="\n            Position: "+this.streamPosition.toFixed(2)+"\n            Timeline: "+this.timelinePosition.toFixed(2)+"\n            Duration: "+this.duration.toFixed(2)+"\n            Live: "+(void 0!==this.livePosition?this.livePosition.toFixed(2):void 0)+"\n            Paused: "+this.paused+"\n            Ended: "+this.ended+"\n            Buffering: "+this.buffering+"\n            Volume: "+this.volume+"\n            Muted: "+this.muted+"\n        "},e.prototype.handleDurationChange=function(){o.Logging.Logger.info("[HlsPlayer] ["+this.id+"] > duration change = "+this.primitivePlayer.duration),this.availabilityController.updateDurationFromVideoElement(this.primitivePlayer.duration),this.timelineController.updateDurationFromVideoElement(this.primitivePlayer.duration)},e.prototype.handleStreamLoaded=function(){o.Logging.Logger.info("[HlsPlayer] ["+this.id+"] > Stream loaded");var e=this.state;this.state=m.PAUSED,e===m.PLAY_WHEN_READY&&this.play()},e.prototype.handlePlay=function(){var e=this.state;this.state=m.PLAYING,e===m.PAUSE_WHEN_ABLE&&this.pause()},e.prototype.handleSeeked=function(){if(this.seekInProgress&&(this.seekInProgress.completionCallback&&this.seekInProgress.completionCallback(),this.seekInProgress=null),this.nextSeek){var e=this.nextSeek;o.Logging.Logger.verbose("[HlsPlayer] ["+this.id+"] > Dequeueing seek to "+e.desiredPosition),this.nextSeek=null,this.setStreamPosition(e.desiredPosition,e.completionCallback)}},e.prototype.dispose=function(){this.primitivePlayer.dispose()},e.prototype.updateStream=function(e){this.availabilityController.updateStream(e),this.timelineController.updateStream(e)},Object.defineProperty(e.prototype,"isPlaying",{get:function(){return this.state===m.PLAY_WHEN_READY||this.state===m.STARTING||this.state===m.PLAYING},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isPlayingActively",{get:function(){return this.state===m.PLAYING},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isInitialized",{get:function(){return this.state!==m.INITIALIZING&&this.state!==m.PLAY_WHEN_READY},enumerable:!0,configurable:!0}),e.prototype.pause=function(){this.state===m.PLAY_WHEN_READY?this.state=m.INITIALIZING:this.state===m.PLAYING?(this.primitivePlayer.pause(),this.state=m.PAUSED):this.state===m.STARTING?this.state=m.PAUSE_WHEN_ABLE:this.logBadTransition("pause()")},e.prototype.play=function(){this.state===m.PAUSED?(this.state=m.STARTING,this.primitivePlayer.play()):this.state===m.INITIALIZING?this.state=m.PLAY_WHEN_READY:this.state===m.PAUSE_WHEN_ABLE?this.state=m.STARTING:this.logBadTransition("play()")},e.prototype.availableAt=function(e){return this.availabilityController.availableAt(e)},Object.defineProperty(e.prototype,"streamPosition",{get:function(){return this.primitivePlayer.streamPosition},set:function(e){this.setStreamPosition(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"livePosition",{get:function(){return this.timelineController.livePosition},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"timelinePosition",{get:function(){return this.timelineController.convertStreamToTimelinePosition(this.primitivePlayer.streamPosition)},enumerable:!0,configurable:!0}),e.prototype.setTimelinePosition=function(e,t){o.Logging.Logger.info("[HlsPlayer] ["+this.id+"] > timelinePosition = "+e),this.setStreamPosition(this.timelineController.convertTimelineToStreamPosition(e),t)},e.prototype.setStreamPosition=function(e,t){o.Logging.Logger.info("[BaseHls] ["+this.id+"] > streamPosition = "+e);var r={desiredPosition:e,callback:t};this.seekInProgress?(o.Logging.Logger.verbose("[HlsPlayer] ["+this.id+"] > Enqueueing seek to "+r.desiredPosition),this.nextSeek=r):this.isPlayingActively||this.primitivePlayer.streamPosition!==e?(this.seekInProgress=r,this.primitivePlayer.streamPosition=e):t&&t()},e.prototype.addEventListener=function(e,t){this.primitivePlayer.addEventListener(e,t)},Object.defineProperty(e.prototype,"muted",{get:function(){return this.primitivePlayer.muted},set:function(e){this.primitivePlayer.muted=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"volume",{get:function(){return this.primitivePlayer.volume},set:function(e){this.primitivePlayer.volume=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){return this.primitivePlayer.duration},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"paused",{get:function(){return this.primitivePlayer.paused},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ended",{get:function(){return this.primitivePlayer.ended},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"playbackRate",{get:function(){return this.primitivePlayer.playbackRate},set:function(e){o.Logging.Logger.info("[HlsPrimitive] ["+this.id+"] > playbackRate",e),this.primitivePlayer.playbackRate=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"buffering",{get:function(){return this._buffering},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bitrateOptions",{get:function(){return this.primitivePlayer.levels.map((function(e){return e.bitrate}))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bitrate",{get:function(){var e=this.primitivePlayer;return e&&-1!==e.currentLevel?e.levels[e.currentLevel].bitrate:0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"bitrateIndex",{get:function(){return this.primitivePlayer.currentLevel},set:function(e){this.isInitialized&&e!==this.primitivePlayer.currentLevel&&(this.primitivePlayer.currentLevel=e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return this._state},set:function(e){e!==this._state&&(o.Logging.Logger.info("[HlsPlayer] ["+this.id+"] > State Transition "+m[this.state]+" -> "+m[e]),this._state=e)},enumerable:!0,configurable:!0}),e.prototype.logBadTransition=function(e){o.Logging.Logger.info("[HlsPlayer] ["+this.id+"] > Unexpected transition: "+e+" called while in state "+m[this.state])},L([l],e.prototype,"handleDurationChange",null),L([l],e.prototype,"handleStreamLoaded",null),L([l],e.prototype,"handlePlay",null),L([l],e.prototype,"handleSeeked",null),e}(),w=(E=function(e,t){return(E=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}E(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}),O=function(e){function t(t,r,i){var n=e.call(this,t,{},r,i,(function(){}))||this;return n.container=r,n.video=i,n}return w(t,e),t.create=function(e){var r=document.createElement("div");r.classList.add("hls-stream-player-container");var i=document.createElement("video");return i.classList.add("hls-stream-player-video"),i.setAttribute("playsinline",""),r.append(i),new t(e,r,i)},t.prototype.attachToDOM=function(e){e.prepend(this.container)},t.prototype.detachFromDOM=function(){this.container.parentNode&&this.container.parentNode.removeChild(this.container)},t}(I);!function(e){e[e.Playing=1]="Playing",e[e.Paused=2]="Paused",e[e.Stopped=3]="Stopped",e[e.Buffering=4]="Buffering"}(C||(C={}));var A,T=function(){function e(e){this.state=e}return e.prototype.addHlsStreamPlayer=function(e){var t=this;e.addEventListener("seeked",(function(r){return t.handlePositionChange(r,e)})),e.addEventListener("timeupdate",(function(r){return t.handlePositionChange(r,e)})),e.addEventListener("ended",(function(r){return t.handlePlayStateChange(r,e)})),e.addEventListener("error",(function(r){return t.handlePlayStateChange(r,e)})),e.addEventListener("pause",(function(r){return t.handlePlayStateChange(r,e)})),e.addEventListener("playing",(function(r){return t.handlePlayStateChange(r,e)})),e.addEventListener("stalled",(function(r){return t.handlePlayStateChange(r,e)})),e.addEventListener("waiting",(function(r){return t.handlePlayStateChange(r,e)}))},e.prototype.updateState=function(e){this.state=e},e.prototype.handlePositionChange=function(e,t){t===this.state.activePrimary&&"seeked"===e.type&&this.loggerSeekHandler&&this.loggerSeekHandler()},e.prototype.handlePlayStateChange=function(e,t){if(t===this.state.activePrimary)if("pause"===e.type){var r=t.streamPosition>=t.duration-.1?C.Stopped:C.Paused;this.loggerPlayStateChangeHandler&&this.loggerPlayStateChangeHandler(C.Playing,r)}else"play"===e.type?t.streamPosition<t.duration&&this.loggerPlayStateChangeHandler&&this.loggerPlayStateChangeHandler(C.Paused,C.Playing):"ended"===e.type&&this.loggerPlayStateChangeHandler&&this.loggerPlayStateChangeHandler(void 0,C.Stopped)},e.prototype.createPlayerInterfaceForPlaybackLogger=function(){var e=this;return{playSpeed:function(){return e.state.playbackRate},streamId:function(){return e.state.activePrimary&&e.state.activePrimary.id},position:function(){return e.state.activePrimary&&e.state.activePrimary.streamPosition||0},onSeek:function(t){e.loggerSeekHandler=t},onPlayStateChangeLog:function(t){e.loggerPlayStateChangeHandler=t},onSpeedChange:function(t){e.loggerSpeedChangeHandler=t}}},e}(),j=r(2),k=r.n(j),N=function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var i=Array(e),n=0;for(t=0;t<r;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,n++)i[n]=o[a];return i},H=function(){function e(e){this.onPlayerCreated=e,this.players={},this.delivery={primaryStreams:[],secondaryStreams:[]}}return e.prototype.updateDelivery=function(e){var t=this;N(e.primaryStreams,e.secondaryStreams).forEach((function(e){if(t.players[e.id])t.players[e.id].updateStream(e);else{var r=O.create(e);t.onPlayerCreated(r),t.players[e.id]=r}})),this.delivery=e},e.prototype.getActivePlayers=function(e){var t=this,r=this.delivery.primaryStreams[this.delivery.primaryStreams.length-1];return{primary:j.chain(this.delivery.primaryStreams).map((function(e){return t.players[e.id]})).filter((function(t){return t.availableAt(e)})).first().value()||this.players[r.id],secondary:j.chain(this.delivery.secondaryStreams).map((function(e){return t.players[e.id]})).filter((function(t){return t.availableAt(e)})).last().value()}},e}(),D=function(){function e(e){this.options=e}return e.prototype.addHlsStreamPlayer=function(e){var t=this;e.addEventListener("seeked",(function(){return t.handlePositionChange(e)})),e.addEventListener("timeupdate",(function(){return t.handlePositionChange(e)})),e.addEventListener("ended",(function(){return t.handlePlayStateChange(e)})),e.addEventListener("error",(function(){return t.handlePlayStateChange(e)})),e.addEventListener("pause",(function(){return t.handlePlayStateChange(e)})),e.addEventListener("playing",(function(){return t.handlePlayStateChange(e)})),e.addEventListener("stalled",(function(){return t.handlePlayStateChange(e)})),e.addEventListener("waiting",(function(){return t.handlePlayStateChange(e)}))},e.prototype.updateState=function(e){var t=e.activePrimary,r=e.activeSecondary,i=e.timelinePosition,n=e.volume,o=e.muted,a=e.paused;t&&(this.setActivePlayers(t,r),t.volume!==n&&(t.volume=n),t.muted!==o&&(t.muted=o)),r&&!r.muted&&(r.muted=!0),void 0!==i&&this.syncPosition(i),this.syncPlayState(a)},e.prototype.setActivePlayers=function(e,t){this.activePrimaryPlayer!==e&&(this.activePrimaryPlayer&&this.activePrimaryPlayer.pause(),this.activePrimaryPlayer=e),this.activeSecondaryPlayer!==t&&(this.activeSecondaryPlayer&&this.activeSecondaryPlayer.pause(),this.activeSecondaryPlayer=t,t&&this.handlePlayStateChange(t))},e.prototype.handlePositionChange=function(e){e===this.activePrimaryPlayer&&this.options.onTimelinePositionChanged(e.timelinePosition)},e.prototype.syncPosition=function(e){if(this.activeSecondaryPlayer&&!this.activeSecondaryPlayer.buffering){var t=this.activeSecondaryPlayer.timelinePosition-e;Math.abs(t)>1&&(o.Logging.Logger.verbose("[SyncController] > diff is outside threshold, sync position triggered",t,e),this.activeSecondaryPlayer.setTimelinePosition(e))}},e.prototype.handlePlayStateChange=function(e){if(e===this.activePrimaryPlayer){o.Logging.Logger.verbose("[SyncController] > primary play state changed",e.paused,e.buffering);var t=e.paused||e.buffering;this.options.onPlayStateChanged(t),this.syncPlayState(t)}else if(this.activePrimaryPlayer&&e===this.activeSecondaryPlayer){t=this.activePrimaryPlayer.paused||this.activePrimaryPlayer.buffering;this.syncPlayState(t)}else e.paused||e.buffering||e.pause()},e.prototype.syncPlayState=function(e){if(this.activeSecondaryPlayer&&!this.activeSecondaryPlayer.buffering&&e!==this.activeSecondaryPlayer.paused)if(e)o.Logging.Logger.verbose("[SyncController] > sync to pause"),this.activeSecondaryPlayer.pause();else{if(this.activeSecondaryPlayer.ended)return;o.Logging.Logger.verbose("[SyncController] > sync to resume"),this.activeSecondaryPlayer.play()}},e}(),R=function(){return(R=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}).apply(this,arguments)},_=function(e,t,r,i){var n,o=arguments.length,a=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,r):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,i);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(a=(o<3?n(a):o>3?n(t,r,a):n(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a};!function(e){e[e.Normal=0]="Normal",e[e.Swapped=1]="Swapped",e[e.PrimaryOnly=2]="PrimaryOnly",e[e.SecondaryOnly=3]="SecondaryOnly"}(A||(A={}));var x,M,F=function(){function e(e,t){this.onStateChanged=t,this.state={playbackRate:1,paused:!0,volume:1,muted:!1,playerLayoutMode:A.Normal},this.playersController=new H(this.handlePlayerCreated),this.layoutController=new B,this.playbackLoggerController=new T(this.state),this.synchronizationController=new D({onTimelinePositionChanged:this.handleTimelinePositionChanged,onPlayStateChanged:this.handlePlayStateChanged}),this.playersController.updateDelivery(e)}return Object.defineProperty(e.prototype,"currentState",{get:function(){return this.state},enumerable:!0,configurable:!0}),e.prototype.createPlayerInterfaceForPlaybackLogger=function(){return this.playbackLoggerController.createPlayerInterfaceForPlaybackLogger()},e.prototype.updateDelivery=function(e){this.playersController.updateDelivery(e);var t=this.state,r=t.timelinePosition,i=t.activePrimary;r&&i&&i.ended&&(i!==this.playersController.getActivePlayers(1/0).primary&&this.start(1/0))},e.prototype.start=function(e){o.Logging.Logger.debug("[TimelineController] > start",e);var t=this.playersController.getActivePlayers(e).primary;e===1/0&&(e=t.livePosition||t.timelinePosition,o.Logging.Logger.debug("[TimelineController] > start",e)),this.handleTimelinePositionChanged(e),t&&(t.setTimelinePosition(e),t.play())},e.prototype.resume=function(){this.currentState.activePrimary&&this.currentState.activePrimary.play()},e.prototype.pause=function(){this.currentState.activePrimary&&this.currentState.activePrimary.pause()},e.prototype.muted=function(e){this.state=R(R({},this.state),{muted:e}),this.notifyStateChange()},e.prototype.volume=function(e){this.state=R(R({},this.state),{volume:e}),this.notifyStateChange()},e.prototype.cyclePlayerLayoutMode=function(){var e=this.state.playerLayoutMode!==A.SecondaryOnly?this.state.playerLayoutMode+1:A.Normal;this.state=R(R({},this.state),{playerLayoutMode:e}),this.notifyStateChange()},e.prototype.seek=function(e){"number"==typeof e&&this.handleTimelinePositionChanged(e)},e.prototype.notifyStateChange=function(){this.layoutController.updateState(this.state),this.playbackLoggerController.updateState(this.state),this.synchronizationController.updateState(this.state),this.onStateChanged(this.state)},e.prototype.handlePlayerCreated=function(e){this.playbackLoggerController.addHlsStreamPlayer(e),this.synchronizationController.addHlsStreamPlayer(e)},e.prototype.handleTimelinePositionChanged=function(e){var t=this.playersController.getActivePlayers(e),r=t.primary,i=t.secondary;this.state=R(R({},this.state),{timelinePosition:e,activePrimary:r,activeSecondary:i}),this.notifyStateChange()},e.prototype.handlePlayStateChanged=function(e){this.state=R(R({},this.state),{paused:e}),this.notifyStateChange()},_([l],e.prototype,"handlePlayerCreated",null),_([l],e.prototype,"handleTimelinePositionChanged",null),_([l],e.prototype,"handlePlayStateChanged",null),e}(),B=function(){function e(){var e=document.getElementById("player"),t=document.getElementById("pipPlayer");if(null===e||null===t)throw Error("#player and/or #pipPlayer not found in DOM.");this.playerElement=e,this.pipPlayerElement=t}return e.prototype.updateState=function(e){var t,r,i=e.activePrimary,n=e.activeSecondary;switch(n?(t=n,r=i):(t=i,r=void 0),e.playerLayoutMode){case A.Normal:this.pipPlayerElement.style.display="block";break;case A.Swapped:if(r){var a=r;r=t,t=a}this.pipPlayerElement.style.display="block";break;case A.PrimaryOnly:t=i,r=void 0,this.pipPlayerElement.style.display="none";break;case A.SecondaryOnly:t=n,r=i,this.pipPlayerElement.style.display="none"}this.currentPlayer!==t&&(o.Logging.Logger.debug("[LayoutController] > player changed",t&&t.id),this.currentPlayer&&this.currentPlayer.detachFromDOM(),t&&t.attachToDOM(this.playerElement),this.currentPlayer=t,this.currentPipPlayer===this.currentPlayer&&(this.currentPipPlayer=void 0)),this.currentPipPlayer!==r&&(o.Logging.Logger.debug("[LayoutController] > pipPlayer changed",r&&r.id),this.currentPipPlayer&&this.currentPipPlayer.detachFromDOM(),r&&r.attachToDOM(this.pipPlayerElement),this.currentPipPlayer=r)},e}();!function(e){e.None="",e.Slide="ppt",e.Transcript="transcript",e.Note="notes",e.Bookmark="bookmarks",e.Comment="comments"}(x||(x={})),function(e){e[e.Slowest=.5]="Slowest",e[e.Slow=.75]="Slow",e[e.Normal=1]="Normal",e[e.Fast=1.25]="Fast",e[e.Faster=1.5]="Faster",e[e.FasterYet=1.75]="FasterYet",e[e.Fastest=2]="Fastest"}(M||(M={}));var U,Y=function(){function e(){}return e.prototype.computeActiveSegments=function(e,t,r){for(var i=[{start:e,end:e+t}],n=0,o=r;n<o.length;n++){for(var a=o[n],s=-1,l=e+a.start,u=e+a.start+a.duration,d=0;d<i.length;d++)if(l>=i[d].start&&u<=i[d].end){s=d;break}if(-1===s)return[];i.push({start:i[s].start,end:l},{start:u,end:i[s].end}),i.splice(s,1),i=i.filter((function(e){return e.end>e.start})).sort((function(e,t){return e.start-t.start}))}return i},e.prototype.computeNewStreamCuts=function(e,t,r,i){for(var n=[],o=0;o<r.length;o++){var a=r[o];if(!(a.end-a.start<i))for(var s=0,l=e;s<l.length;s++){for(var u=l[s],d=0;d<t.length;d++){var c=t[d];if(!(c.targetId!==u.id||c.duration<=i)){var p=Math.max(a.start,u.absoluteStart+c.start),h=Math.min(a.end,u.absoluteStart+c.start+c.duration);if(!(p>=a.end||h<=a.start))if(a.start<=u.absoluteStart+c.start&&u.absoluteStart+c.start+c.duration<a.end)c.duration=0,r.splice(o+1,0,{start:h,end:a.end}),a.end=p;else if(u.absoluteStart+c.start<p&&u.absoluteStart+c.start+c.duration<=a.end)c.duration-=h-p,a.start=h;else if(a.start<=u.absoluteStart+c.start&&h<u.absoluteStart+c.start+c.duration)c.start+=h-p,c.duration-=h-p,a.end=p;else{var y=c.copy();y.id=k.a.uniqueId("cut"),y.start=h-u.absoluteStart,y.duration=c.duration-(h-(u.absoluteStart+c.start)),t.splice(d+1,0,y),c.duration=c.duration-y.duration-(h-p),a.start=a.end}}}if(a.end-a.start<i)break}}return t.forEach((function(e){e.duration<=i&&n.push(e)})),n},e.prototype.computeNewSessionCuts=function(e,t,r,i,n,o){for(var a=[],s=[],l=0,u=e;l<u.length;l++){var d=u[l],c=(d.start-i)/o,p=(d.start+d.duration-i)/o;c>=r||p<=t?a.push(d):c<=t&&p>=r?a.push(d):c<t?s.push({oldStart:d.start-i,newStart:n,newEnd:d.start+d.duration-t*o-i+n,newTargetId:d.targetId,newTargetType:d.targetType}):p>r?s.push({oldStart:d.start-i,newStart:d.start-i-t*o+n,newEnd:(r-t)*o+n,newTargetId:d.targetId,newTargetType:d.targetType}):s.push({oldStart:d.start-i,newStart:d.start-i-t*o+n,newEnd:d.start+d.duration-t*o-i+n,newTargetId:d.targetId,newTargetType:d.targetType})}return{resizeHandlers:s,cutsToRemove:a}},e}();!function(e){e[e.OnlyPrimary=0]="OnlyPrimary",e[e.ActivePrimary=1]="ActivePrimary",e[e.InactivePrimary=2]="InactivePrimary",e[e.Secondary=3]="Secondary",e[e.Unexpected=4]="Unexpected"}(U||(U={}));var G,V=function(){function e(e,t){this.brandElement=e?this.renderImgOnly(t):this.render(t)}return e.prototype.render=function(t){var r=$(e.template());return $(r).find(".logo-while-playing").attr("src",t),r},e.prototype.renderImgOnly=function(t){return $(e.templateImgOnly({logo:t}))},e.prototype.setHeight=function(e){$(this.brandElement).find(".logo-box").height(e)},e.prototype.getBrandElem=function(){return this.brandElement},e.template=j.template('\n        <div class="logo-container-while-playing">\n            <img class="logo-while-playing" />\n            <div class="logo-box"></div>\n        </div>'),e.templateImgOnly=j.template('\n        <img class="logo-container-while-playing logo-while-playing"\n            src="<@= logo @>" \n            />'),e}();!function(e){e[e.Audio=0]="Audio",e[e.Screen=1]="Screen",e[e.Slide=2]="Slide",e[e.Camera=3]="Camera"}(G||(G={})),r.d(t,"createHlsPrimitivePlayer",(function(){return h})),r.d(t,"DeliveryService",(function(){return v})),r.d(t,"EmbedApiMessagesToFrame",(function(){return y})),r.d(t,"EmbedApiMessagesToParent",(function(){return g})),r.d(t,"EmbedApiParser",(function(){return P})),r.d(t,"EmbedHlsStreamPlayer",(function(){return O})),r.d(t,"HlsPrimitivePlayer",(function(){return p})),r.d(t,"HlsStreamPlayer",(function(){return I})),r.d(t,"HlsStreamPlayerAvailabilityController",(function(){return b})),r.d(t,"HlsStreamPlayerErrorController",(function(){return d})),r.d(t,"HlsStreamPlayerTimelineController",(function(){return S})),r.d(t,"HlsjsDebugLogger",(function(){return a})),r.d(t,"LayoutController",(function(){return B})),r.d(t,"EventType",(function(){return x})),r.d(t,"PlaySpeed",(function(){return M})),r.d(t,"PlaybackLoggerController",(function(){return T})),r.d(t,"PlayersController",(function(){return H})),r.d(t,"StreamDeleteUtils",(function(){return Y})),r.d(t,"StreamDeleteCase",(function(){return U})),r.d(t,"SynchronizationController",(function(){return D})),r.d(t,"PlayerLayoutMode",(function(){return A})),r.d(t,"TimelineController",(function(){return F})),r.d(t,"WatermarkLogo",(function(){return V})),r.d(t,"Data",(function(){return i}))}])}));
//# sourceMappingURL=file://seasyn/tfsbuilds/panopto_core_rel-rtc-9.9.2_x64/20201026.33/_PublishedWebsites/WebUI/Scripts/Panopto/Bundles/viewer.umd.js.map